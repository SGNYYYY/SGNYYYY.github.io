<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Sam&#39;s Blog</title>
  
  <subtitle>小上上上上的博客</subtitle>
  <link href="https://sgnyyyy.github.io/atom.xml" rel="self"/>
  
  <link href="https://sgnyyyy.github.io/"/>
  <updated>2025-05-14T16:13:10.272Z</updated>
  <id>https://sgnyyyy.github.io/</id>
  
  <author>
    <name>SGNYYYY</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>简单DNS客户端编写</title>
    <link href="https://sgnyyyy.github.io/2025/05/07/%E7%AE%80%E5%8D%95DNS%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BC%96%E5%86%99/"/>
    <id>https://sgnyyyy.github.io/2025/05/07/%E7%AE%80%E5%8D%95DNS%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BC%96%E5%86%99/</id>
    <published>2025-05-07T10:20:34.000Z</published>
    <updated>2025-05-14T16:13:10.272Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简单DNS客户端编写"><a href="#简单DNS客户端编写" class="headerlink" title="简单DNS客户端编写"></a>简单DNS客户端编写</h2><h3 id="目标："><a href="#目标：" class="headerlink" title="目标："></a>目标：</h3><ul><li>可使用参数来设置解析的域名类型，拨测数量，期望结果</li><li>执行DNS解析并获取结果</li></ul><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.xbill.DNS.Lookup;</span><br><span class="line"><span class="keyword">import</span> org.xbill.DNS.Type;</span><br><span class="line"><span class="keyword">import</span> org.xbill.DNS.Record;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DNSClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 参数解析</span></span><br><span class="line">        <span class="keyword">if</span> (args.length &lt; <span class="number">4</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Usage: java DNSClient &lt;domain&gt; &lt;recordType&gt; &lt;attempts&gt; &lt;expectedResult&gt;&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Example: java DNSClient example.com A 3 93.184.216.34&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">domain</span> <span class="operator">=</span> args[<span class="number">0</span>];</span><br><span class="line">        <span class="type">String</span> <span class="variable">recordTypeStr</span> <span class="operator">=</span> args[<span class="number">1</span>].toUpperCase();</span><br><span class="line">        <span class="type">int</span> <span class="variable">attempts</span> <span class="operator">=</span> Integer.parseInt(args[<span class="number">2</span>]);</span><br><span class="line">        <span class="type">String</span> <span class="variable">expectedResult</span> <span class="operator">=</span> args[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取记录类型代码</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">recordType</span> <span class="operator">=</span> getRecordType(recordTypeStr);</span><br><span class="line">        <span class="keyword">if</span> (recordType == -<span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Unsupported record type: &quot;</span> + recordTypeStr);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行拨测</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= attempts; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Attempt &quot;</span> + i + <span class="string">&quot;: Querying &quot;</span> + domain + <span class="string">&quot; for &quot;</span> + recordTypeStr + <span class="string">&quot;... &quot;</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Lookup</span> <span class="variable">lookup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Lookup</span>(domain, recordType);</span><br><span class="line">                Record[] records = lookup.run();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (records == <span class="literal">null</span> || records.length == <span class="number">0</span>) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;No records found.&quot;</span>);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 检查结果是否包含期望值</span></span><br><span class="line">                <span class="type">boolean</span> <span class="variable">found</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">for</span> (Record record : records) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> record.rdataToString();</span><br><span class="line">                    System.out.println(result);</span><br><span class="line">                    <span class="keyword">if</span> (result.contains(expectedResult)) &#123;</span><br><span class="line">                        found = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (found) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;✅ Expected result found: &quot;</span> + expectedResult);</span><br><span class="line">                    success = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;❌ No expected result found.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;Error: &quot;</span> + e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!success) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;⚠️ All attempts failed. Expected result not found: &quot;</span> + expectedResult);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将记录类型字符串转换为DNSJava的记录类型代码</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getRecordType</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;A&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> Type.A;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;AAAA&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> Type.AAAA;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;CNAME&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> Type.CNAME;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;MX&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> Type.MX;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;TXT&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> Type.TXT;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;NS&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> Type.NS;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;SOA&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> Type.SOA;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -cp .:DNSClient-1.0-SNAPSHOT.jar DNSClient www.aliyun.com A 1 93.184.216.34</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Go"><a href="#Go" class="headerlink" title="Go"></a>Go</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;flag&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;github.com/miekg/dns&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">msg       = <span class="built_in">new</span>(dns.Msg)</span><br><span class="line">dnsServer = <span class="string">&quot;223.5.5.5:53&quot;</span></span><br><span class="line">client    = <span class="built_in">new</span>(dns.Client)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ResolveRecord</span><span class="params">(domain <span class="type">string</span>, recordType <span class="type">string</span>, count <span class="type">int</span>, expected <span class="type">string</span>)</span></span> <span class="type">error</span> &#123;</span><br><span class="line">dnsType := RecordType2DnsType(recordType)</span><br><span class="line"><span class="comment">// 创建 DNS 消息</span></span><br><span class="line">msg.SetQuestion(dns.Fqdn(domain), dnsType)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="keyword">range</span> count &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Querying DNS for %s (%d/%d)\n&quot;</span>, domain, i+<span class="number">1</span>, count)</span><br><span class="line"><span class="comment">// 发送 DNS 查询</span></span><br><span class="line">response, _, err := client.Exchange(msg, dnsServer)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Failed to query DNS for %s: %v\n&quot;</span>, domain, err)</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理响应</span></span><br><span class="line"><span class="keyword">if</span> response.Rcode != dns.RcodeSuccess &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;DNS query failed with Rcode %d\n&quot;</span>, response.Rcode)</span><br><span class="line"><span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;DNS query failed with Rcode %d&quot;</span>, response.Rcode)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查记录里面有没有预期的值，判断所有的记录类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> expected != <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">found := <span class="literal">false</span></span><br><span class="line"><span class="keyword">for</span> _, answer := <span class="keyword">range</span> response.Answer &#123;</span><br><span class="line"><span class="keyword">switch</span> recordType &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;A&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.A); ok &amp;&amp; record.A.String() == expected &#123;</span><br><span class="line">found = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;AAAA&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.AAAA); ok &amp;&amp; record.AAAA.String() == expected &#123;</span><br><span class="line">found = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;CNAME&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.CNAME); ok &amp;&amp; record.Target == expected &#123;</span><br><span class="line">found = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;MX&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.MX); ok &amp;&amp; record.Mx == expected &#123;</span><br><span class="line">found = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;NS&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.NS); ok &amp;&amp; record.Ns == expected &#123;</span><br><span class="line">found = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;TXT&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.TXT); ok &#123;</span><br><span class="line"><span class="keyword">for</span> _, txt := <span class="keyword">range</span> record.Txt &#123;</span><br><span class="line"><span class="keyword">if</span> txt == expected &#123;</span><br><span class="line">found = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">fmt.Printf(<span class="string">&quot;Unknown record type: %d\n&quot;</span>, answer.Header().Rrtype)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> !found &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Expected value %s not found in DNS response\n&quot;</span>, expected)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Expected value %s found in DNS response\n&quot;</span>, expected)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 打印响应</span></span><br><span class="line"><span class="keyword">for</span> _, answer := <span class="keyword">range</span> response.Answer &#123;</span><br><span class="line"><span class="keyword">switch</span> recordType &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;A&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.A); ok &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;A record: %s\n&quot;</span>, record.A.String())</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;AAAA&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.AAAA); ok &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;AAAA record: %s\n&quot;</span>, record.AAAA.String())</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;CNAME&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.CNAME); ok &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;CNAME record: %s\n&quot;</span>, record.Target)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;MX&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.MX); ok &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;MX record: %s\n&quot;</span>, record.Mx)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;NS&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.NS); ok &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;NS record: %s\n&quot;</span>, record.Ns)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;TXT&quot;</span>:</span><br><span class="line"><span class="keyword">if</span> record, ok := answer.(*dns.TXT); ok &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;TXT record: %s\n&quot;</span>, record.Txt)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">fmt.Printf(<span class="string">&quot;Unknown record type: %d\n&quot;</span>, answer.Header().Rrtype)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 休眠 1 秒</span></span><br><span class="line">time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RecordType2DnsType 将 DNS 记录类型转换为 dns.Type</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RecordType2DnsType</span><span class="params">(recordType <span class="type">string</span>)</span></span> <span class="type">uint16</span> &#123;</span><br><span class="line"><span class="keyword">switch</span> recordType &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;A&quot;</span>:</span><br><span class="line"><span class="keyword">return</span> dns.TypeA</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;AAAA&quot;</span>:</span><br><span class="line"><span class="keyword">return</span> dns.TypeAAAA</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;CNAME&quot;</span>:</span><br><span class="line"><span class="keyword">return</span> dns.TypeCNAME</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;MX&quot;</span>:</span><br><span class="line"><span class="keyword">return</span> dns.TypeMX</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;NS&quot;</span>:</span><br><span class="line"><span class="keyword">return</span> dns.TypeNS</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;TXT&quot;</span>:</span><br><span class="line"><span class="keyword">return</span> dns.TypeTXT</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">domain := flag.String(<span class="string">&quot;domain&quot;</span>, <span class="string">&quot;example.com&quot;</span>, <span class="string">&quot;The domain name to query.&quot;</span>)</span><br><span class="line">recordType := flag.String(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;A&quot;</span>, <span class="string">&quot;The type of DNS record (A, AAAA, etc.)&quot;</span>)</span><br><span class="line">count := flag.Int(<span class="string">&quot;count&quot;</span>, <span class="number">3</span>, <span class="string">&quot;Number of DNS queries to perform.&quot;</span>)</span><br><span class="line">expected := flag.String(<span class="string">&quot;expected&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;Expected result from the DNS query.&quot;</span>)</span><br><span class="line">flag.Parse()</span><br><span class="line"></span><br><span class="line">err := ResolveRecord(*domain, *recordType, *count, *expected)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Error resolving domain %s: %v\n&quot;</span>, *domain, err)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;Successfully resolved domain %s\n&quot;</span>, *domain)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析 DNS 记录</span></span><br><span class="line"><span class="comment">// 该代码使用 miekg/dns 库来查询 DNS 记录</span></span><br><span class="line"><span class="comment">// 你需要安装该库：go get github.com/miekg/dns</span></span><br><span class="line"><span class="comment">// 运行代码前，请确保你的 Go 环境已正确设置</span></span><br><span class="line"><span class="comment">// 运行代码：go run main.go -domain=www.aliyun.com  -type=A -count=3 -expected=93.184.216.34</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run main.go -domain=www.aliyun.com  -type=A -count=3 -expected=93.184.216.34</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;简单DNS客户端编写&quot;&gt;&lt;a href=&quot;#简单DNS客户端编写&quot; class=&quot;headerlink&quot; title=&quot;简单DNS客户端编写&quot;&gt;&lt;/a&gt;简单DNS客户端编写&lt;/h2&gt;&lt;h3 id=&quot;目标：&quot;&gt;&lt;a href=&quot;#目标：&quot; class=&quot;header</summary>
      
    
    
    
    <category term="DNS" scheme="https://sgnyyyy.github.io/categories/DNS/"/>
    
    
  </entry>
  
  <entry>
    <title>DNS基本工具</title>
    <link href="https://sgnyyyy.github.io/2025/05/07/DNS%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7/"/>
    <id>https://sgnyyyy.github.io/2025/05/07/DNS%E5%9F%BA%E6%9C%AC%E5%B7%A5%E5%85%B7/</id>
    <published>2025-05-07T10:20:26.000Z</published>
    <updated>2025-05-09T06:30:23.330Z</updated>
    
    <content type="html"><![CDATA[<h2 id="DNS基本工具"><a href="#DNS基本工具" class="headerlink" title="DNS基本工具"></a>DNS基本工具</h2><h3 id="使用命令行工具如dig、nslookup进行DNS查询"><a href="#使用命令行工具如dig、nslookup进行DNS查询" class="headerlink" title="使用命令行工具如dig、nslookup进行DNS查询"></a>使用命令行工具如dig、nslookup进行DNS查询</h3><h3 id="dig"><a href="#dig" class="headerlink" title="dig"></a>dig</h3><p>参考 <a href="https://www.sysgeek.cn/linux-dig/">系统极客</a></p><p>dig 命令可以查询各种类型 DNS 记录信息，包括：主机名称记录（A、AAAA）、邮件交换记录（MX）和别名记录（CNAME）等等。由于其灵活性和易用性，它是系统管理员解决 DNS 问题时最常用的工具。</p><blockquote><h4 id="验证是否安装dig"><a href="#验证是否安装dig" class="headerlink" title="验证是否安装dig"></a>验证是否安装dig</h4></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig -v</span><br></pre></td></tr></table></figure><blockquote><h4 id="dig命令语法"><a href="#dig命令语法" class="headerlink" title="dig命令语法"></a>dig命令语法</h4></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig [server] [name] [type]</span><br></pre></td></tr></table></figure><ul><li>[server]查询指向的主机名或 IP 地址</li><li>[name]要查询服务器的 DNS（域名服务器）</li><li>[type]要检索的 DNS 记录类型。默认情况下（或如果留空），dig 查询 A 记录。</li></ul><blockquote><h4 id="dig命令输出"><a href="#dig命令输出" class="headerlink" title="dig命令输出"></a>dig命令输出</h4></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig www.aliyun.com</span><br></pre></td></tr></table></figure><p><img src="/images/dns/dig_output.png" alt="dig_output"></p><p>第一行显示 dig 命令的版本，以及查询的域名；</p><p>第二行显示全局选项（默认情况下，仅有 cmd）</p><p><code>HEADER</code>部分显示从被请求机构（DNS 服务器）收到响应的详细技术信息。标题显示由 dig 执行操作的「操作码」和「操作状态」的「标头」，上述示例中的「操作状态」是NOERROR，这意味着被请求的 DNS 服务器可以没有任何阻碍地提供查询。<br>Flags是回答格式的参考。</p><p><code>OPT PSEUDOSECTION</code>显示高级数据</p><ul><li><code>EDNS </code>DNS 的扩展机制</li><li><code>Flags</code> 未指定标志时为空</li><li><code>UDP</code> UDP 数据包大小</li></ul><p><code>QUESTION</code>部分显示发送的查询数据：</p><ul><li>第一列是查询的域名</li><li>第二列是查询的类型（IN 表示互联网）</li><li>第三列指定了记录类型（如果未指定则默查询 A 记录）</li></ul><p>最重要的部分是<code>ANSWER</code>部分：</p><ul><li>第一列列出了被查询的服务器名称</li><li>第二列是 <code>TTL</code>（存活时间），在此之后记录将被刷新</li><li>第三列显示查询的类别 – 在本例中，<code>IN</code>代表互联网</li><li>第四列显示查询的类型 – 在本例中，<code>CNAME</code>代表 CNAME（别名）记录，<code>A</code>代表 A（地址）记录</li><li>最后一列显示与域名关联的别名和 IP 地址（结果）</li></ul><p>最后的<code>STATISTICS</code>统计信息部分显示关于查询的元数据:</p><ul><li><code>Query time</code>响应花费的时间</li><li><code>SERVER</code> 响应 DNS 服务器的 IP 地址和端口</li><li><code>WHEN</code>命令运行的时间戳</li><li><code>MSG SIZE rcvd</code>从 DNS 服务器收到的回复大小</li></ul><blockquote><h4 id="指定DNS服务器"><a href="#指定DNS服务器" class="headerlink" title="指定DNS服务器"></a>指定DNS服务器</h4></blockquote><p>默认情况下，如果未指定名称服务器，dig 命令会使用&#x2F;etc&#x2F;resolv.conf文件中列出的服务器进行查询。</p><p>要指定 DNS 服务器进行查询，可以使用@后跟 DNS 服务器 IP 地址的方式来手动指定 DNS 服务器。</p><p>例如，要使用 阿里云 DNS 的233.5.5.5查询<a href="http://www.aliyun.com域名,可以使用如下/">www.aliyun.com域名，可以使用如下</a> 命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig www.aliyun.com @233.5.5.5</span><br></pre></td></tr></table></figure><blockquote><h4 id="仅输出响应结果"><a href="#仅输出响应结果" class="headerlink" title="仅输出响应结果"></a>仅输出响应结果</h4></blockquote><p>在绝大多数情况下，只使用 dig 查询相应的 DNS 记录，而不需要太多复杂的、不相关的响应和输出。此时就可以使用以下两种方式。</p><ul><li>输出简短结果</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig www.aliyun.com +short</span><br></pre></td></tr></table></figure><ul><li>输出详细响应，先使用<code>+noall</code>参数关闭所有结果，再使用<code>+answer</code>参数打开结果部分。</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig www.aliyun.com +noall +answer</span><br></pre></td></tr></table></figure><blockquote><h4 id="使用dig命令查询特定记录类型"><a href="#使用dig命令查询特定记录类型" class="headerlink" title="使用dig命令查询特定记录类型"></a>使用dig命令查询特定记录类型</h4></blockquote><ul><li>查询A记录，要获取域名的所有 IP 地址列表，请使用a参数：</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +nocmd www.aliyun.com a +noall +answer</span><br></pre></td></tr></table></figure><p><img src="/images/dns/dig_a.png" alt="dig_a"></p><ul><li>查询CNAME记录<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +nocmd www.aliyun.com cname +noall +answer</span><br></pre></td></tr></table></figure></li></ul><p><img src="/images/dns/dig_cname.png" alt="dig_cname"></p><ul><li>查询TXT记录，使用<code>txt</code>参数检索特定域的所有「TXT 记录」：<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +nocmd aliyun.com txt +noall +answer</span><br></pre></td></tr></table></figure><img src="/images/dns/dig_txt.png" alt="dig_txt"></li><li>查询MX记录，获取特定域的所有邮件交换记录<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +nocmd aliyun.com mx +noall +answer</span><br></pre></td></tr></table></figure><img src="/images/dns/dig_mx.png" alt="dig_mx"></li><li>查询NS记录，查找特定域的权威名称服务器<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig +nocmd aliyun.com ns +noall +answer</span><br></pre></td></tr></table></figure><img src="/images/dns/dig_ns.png" alt="dig_ns"></li></ul><blockquote><h4 id="使用-dig-命令进行-PTR-反向-DNS-查询"><a href="#使用-dig-命令进行-PTR-反向-DNS-查询" class="headerlink" title="使用 dig 命令进行 PTR 反向 DNS 查询"></a>使用 dig 命令进行 PTR 反向 DNS 查询</h4></blockquote><p>要查询与特定 IP 地址关联的主机名，请使用-x参数。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig -x 208.118.235.148 +noall +answer</span><br></pre></td></tr></table></figure><p><img src="/images/dns/dig_ptr.png" alt="dig_ptr"></p><blockquote><h4 id="Trace-参数"><a href="#Trace-参数" class="headerlink" title="Trace 参数"></a>Trace 参数</h4></blockquote><p><code>+trace</code>参数可以列出查询经过的不同 DNS 服务器，直到最终目的地。可以使用此参数来确定流量中断的 IP 地址:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig aliyun.com +trace</span><br></pre></td></tr></table></figure><blockquote><h4 id="dig-命令批量-DNS-查询"><a href="#dig-命令批量-DNS-查询" class="headerlink" title="dig 命令批量 DNS 查询"></a>dig 命令批量 DNS 查询</h4></blockquote><p>如果要对大量域名进行 DNS 查询，可以将其全部写入到一个文本文件中（一行一个），然后使用-f参数，再跟止文件名即可，例如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dig -f domains.txt +short</span><br></pre></td></tr></table></figure><blockquote><h4 id="digrc-文件"><a href="#digrc-文件" class="headerlink" title=".digrc 文件"></a>.digrc 文件</h4></blockquote><p>还可通过不同用户的${HOME}&#x2F;.digrc文件来控制 dig 命令的行为，如果.digrc文件存在于用户的主目录中，则 dig 可以读取其中的参数，而无需用户在执行命令时手动添加。例如，直接在~&#x2F;.digrc文件中写入+nocmd +noall +answer参数。</p><h3 id="nslookup"><a href="#nslookup" class="headerlink" title="nslookup"></a>nslookup</h3><p><code>nslookup</code>代表 名称服务器查找。它是一个命令行工具，用于查询 DNS（域名系统）服务器，以检索有关域名、IP 地址和其他 DNS 记录的信息。通过促进 DNS 查询，<code>nslookup</code> 帮助用户和管理员诊断和解决与 DNS 相关的问题。</p><h4 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h4><ul><li>验证 DNS 服务器配置。</li><li>确认 DNS 记录的存在和配置。</li><li>检测 DNS 传播问题。</li><li>协助排除与 DNS 相关的连接问题。</li></ul><h4 id="与其他-DNS-工具的区别"><a href="#与其他-DNS-工具的区别" class="headerlink" title="与其他 DNS 工具的区别"></a>与其他 DNS 工具的区别</h4><ul><li>dig（域信息探测器）： 提供比 nslookup 更详细和灵活的查询选项。许多网络管理员更喜欢它，因为它的输出更全面。</li><li>host： 一个更简单的 DNS 查找工具，适合快速查询而无需大量输出。</li></ul><h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup [选项] [主机名] [DNS 服务器]</span><br></pre></td></tr></table></figure><h4 id="基本主机名查找"><a href="#基本主机名查找" class="headerlink" title="基本主机名查找"></a>基本主机名查找</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup www.aliyun.com</span><br></pre></td></tr></table></figure><h4 id="反向-IP-查找"><a href="#反向-IP-查找" class="headerlink" title="反向 IP 查找"></a>反向 IP 查找</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup xxx.xxx.xxx.xxx</span><br></pre></td></tr></table></figure><h4 id="指定-DNS-服务器"><a href="#指定-DNS-服务器" class="headerlink" title="指定 DNS 服务器"></a>指定 DNS 服务器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup www.aliyun.com 223.5.5.5</span><br></pre></td></tr></table></figure><h4 id="设置查询类型"><a href="#设置查询类型" class="headerlink" title="设置查询类型"></a>设置查询类型</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -type=[记录类型] [主机名]</span><br></pre></td></tr></table></figure><ul><li><p>检索A记录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -type=A www.aliyun.com</span><br></pre></td></tr></table></figure></li><li><p>检索MX记录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -type=MX aliyun.com</span><br></pre></td></tr></table></figure></li><li><p>检索CNAME记录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup -type=CNAME www.aliyun.com</span><br></pre></td></tr></table></figure></li></ul><h4 id="交互模式"><a href="#交互模式" class="headerlink" title="交互模式"></a>交互模式</h4><ul><li>set type&#x3D;[记录类型]： 指定要查询的 DNS 记录类型（例如 A、MX、CNAME）。</li><li>server [DNS 服务器]： 更改会话中用于查询的 DNS 服务器。</li><li>exit： 退出交互模式。</li></ul><h4 id="在脚本中使用-nslookup"><a href="#在脚本中使用-nslookup" class="headerlink" title="在脚本中使用 nslookup"></a>在脚本中使用 <code>nslookup</code></h4><p><code>nslookup</code> 可以集成到脚本中，以自动化 DNS 查询，实现批处理和 DNS 记录监控。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">要查询的域名列表</span></span><br><span class="line">domains=(&quot;example.com&quot; &quot;google.com&quot; &quot;nonexistentdomain.xyz&quot;)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">要使用的 DNS 服务器</span></span><br><span class="line">dns_server=&quot;8.8.8.8&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">遍历每个域名并执行 A 记录查找</span></span><br><span class="line">for domain in &quot;$&#123;domains[@]&#125;&quot;; do</span><br><span class="line">    echo &quot;正在使用 DNS 服务器 $dns_server 查询 $domain 的 A 记录&quot;</span><br><span class="line">    nslookup -type=A &quot;$domain&quot; &quot;$dns_server&quot;</span><br><span class="line">    echo &quot;----------------------------------------&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h3 id="常见的DNS系统（如：Bind、PowerDNS等）及相关软件特性"><a href="#常见的DNS系统（如：Bind、PowerDNS等）及相关软件特性" class="headerlink" title="常见的DNS系统（如：Bind、PowerDNS等）及相关软件特性"></a>常见的DNS系统（如：Bind、PowerDNS等）及相关软件特性</h3><h4 id="Bind"><a href="#Bind" class="headerlink" title="Bind"></a>Bind</h4><p>BIND（Berkeley Internet Name Domain）作为一款目前市面是最主流的开源DNS软件，占据了市面上DNS服务器软件的九成，目前由 互联网系统协会 (Internet Systems Consortium) 负责开发和维护。</p><h4 id="PowerDNS"><a href="#PowerDNS" class="headerlink" title="PowerDNS"></a>PowerDNS</h4><p>PowerDNS（PDNS）成立于20世纪90年代末，是开源DNS软件、服务和支持的主要供应商，它们提供的权威认证DNS服务器和递归认证DNS服务器都是100%开源的软件，同时也和红帽等开源方案提供商一样提供了付费的技术支持版本。同时官方表示为了避免和软件使用者出现竞争，他们只提供服务支持而不提供DNS托管服务。</p><h3 id="编程语言中常用的相关库（Go-Java）"><a href="#编程语言中常用的相关库（Go-Java）" class="headerlink" title="编程语言中常用的相关库（Go, Java）"></a>编程语言中常用的相关库（Go, Java）</h3><h4 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h4><p>DNSJava</p><h4 id="Go"><a href="#Go" class="headerlink" title="Go"></a>Go</h4><p><a href="https://github.com/miekg/dns">https://github.com/miekg/dns</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get github.com/miekg/dns</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;DNS基本工具&quot;&gt;&lt;a href=&quot;#DNS基本工具&quot; class=&quot;headerlink&quot; title=&quot;DNS基本工具&quot;&gt;&lt;/a&gt;DNS基本工具&lt;/h2&gt;&lt;h3 id=&quot;使用命令行工具如dig、nslookup进行DNS查询&quot;&gt;&lt;a href=&quot;#使用命令行工</summary>
      
    
    
    
    <category term="DNS" scheme="https://sgnyyyy.github.io/categories/DNS/"/>
    
    
  </entry>
  
  <entry>
    <title>DNS基础知识</title>
    <link href="https://sgnyyyy.github.io/2025/05/06/DNS%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/"/>
    <id>https://sgnyyyy.github.io/2025/05/06/DNS%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/</id>
    <published>2025-05-06T05:40:06.000Z</published>
    <updated>2025-05-07T14:34:18.484Z</updated>
    
    <content type="html"><![CDATA[<h2 id="DNS基本概念"><a href="#DNS基本概念" class="headerlink" title="DNS基本概念"></a>DNS基本概念</h2><h3 id="DNS的主要功能"><a href="#DNS的主要功能" class="headerlink" title="DNS的主要功能"></a>DNS的主要功能</h3><p>DNS（Domain Name System）是因特网的一项服务，它作为<strong>域名和IP地址相互映射</strong>的一个<strong>分布式数据库</strong>，能够使人更方便的访问互联网。</p><p>解析域名：将域名解析成相应的IP地址</p><p>域名管理：管理互联网上的所有域名，包括注册、续费、修改、删除等操作。</p><p>负载均衡：将请求分发到不同的服务器上，实现负载均衡和高可用性。</p><p>在底层原理方面，DNS服务主要依赖于分布式数据库系统和递归查询机制。具体来说，DNS服务将所有的域名和IP地址存储在一个分布式的数据库系统中，每个DNS服务器都存储了一部分数据。当用户输入一个域名时，本地DNS服务器会先进行查询，如果本地DNS服务器没有相应的记录，则会向根域名服务器发送请求。根域名服务器将返回一个指向相应顶级域名服务器的IP地址。然后本地DNS服务器再向顶级域名服务器发送请求，顶级域名服务器会返回一个指向相应二级域名服务器的IP地址，以此类推，直到最终得到目标域名的IP地址。</p><p>需要注意的是，DNS查询过程中采用的是递归查询机制，即本地DNS服务器会向根域名服务器、顶级域名服务器、二级域名服务器等逐层发送查询请求，直到得到目标域名的IP地址为止。这种查询方式可以保证数据的安全性和可靠性，同时也可以防止DNS攻击和DNS污染等安全问题。</p><h3 id="DNS结构层次"><a href="#DNS结构层次" class="headerlink" title="DNS结构层次"></a>DNS结构层次</h3><p>域名的层次结构：</p><ul><li>根域，域名空间最顶层，一般用一个’.’表示</li><li>顶级域，代表一种类型的组织机构或者国家地区</li><li>二级域，标明顶级域内的的一个特定组织</li><li>子域，二级域下所创建的各级域统称为子域</li><li>主机，域名空间最下层，就是一台具体的计算机</li></ul><p>顶级域名（TLD）、二级域名、子域名的概念：</p><ul><li>顶级域名：Top-level domains（TLD）</li><li>二级域名：Second-level domain（SLD），处于顶级域名之下的域。二级域名是域名的倒数第二个部分</li><li>子域名：Subdomain，凡顶级域名前加前缀的都是该顶级域名的子域名，而子域名根据技术的多少分为二级子域名，三级子域名以及多级子域名。</li></ul><h3 id="DNS记录类型"><a href="#DNS记录类型" class="headerlink" title="DNS记录类型"></a>DNS记录类型</h3><p>A记录、AAAA记录、CNAME记录、MX记录、NS记录、TXT记录等</p><p>各种记录的作用与使用场景：</p><ul><li><p>A记录，Address，也称主机记录，一个主机域名对应的ipv4地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">www.baidu.com. IN A 1.1.1.2</span><br><span class="line">mx1.baidu.com. IN A 1.1.1.3</span><br></pre></td></tr></table></figure></li><li><p>AAAA记录，一个主机域名对应的ipv6记录</p></li><li><p>CNAME记录，Canonical Name，别名记录，让一个服务器有多个域名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web.sangfor.com. IN CNAME www.sanfor.com.</span><br></pre></td></tr></table></figure></li><li><p>MX记录，Mail Exchanger 邮件交换记录，用于说明哪台服务器是当前区域的邮件服务器，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">magedu.com. IN MX 10 mx1.magedu.com.</span><br><span class="line">IN MX 20 mx2.magedu.com.</span><br></pre></td></tr></table></figure></li><li><p>NS记录，Name Server，域名服务器记录，用来指定该域名由哪个DNS服务器来解析，NS记录依赖A记录的解析，NS记录说明，在这个区域里，有多少个服务器承担解析的任务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">baidu.com. IN NS ns1.baidu.com.</span><br><span class="line">baidu.com. IN NS ns2.baidu.com.</span><br></pre></td></tr></table></figure></li><li><p>TXT记录，一般指某个主机或域名的说明</p></li><li><p>PTR记录，逆向查询记录，用于从ip地址中查询域名。PTR记录是A记录的逆向记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4.3.2.1.in-addr.arpa IN PTR www.sangfor.com.</span><br></pre></td></tr></table></figure></li></ul><p>TTL（生存时间Time-To-Live）对DNS记录的影响：</p><p>TTL是IP协议包中的一个值，它告诉网络路由器包在网络中的时间是否太长而应被丢弃。TTL就是一条域名解析记录在DNS服务器中的存留时间。<br>TTL值设置大：节约域名解析时间，给网站访问加速<br>TTL值设置小：减少更换空间时的不可访问时间。更换空间99.9%会有DNS记录更改的问题，因为缓存的问题，新的域名记录在有的地方可能生效，但是在有的地方可能等到一两天甚至更久才生效。访问无所谓，但是涉及到邮件发送就比较麻烦。<br>一般操作系统的默认TTL值如下： TTL&#x3D;32 Windows 9x&#x2F;Me TTL&#x3D;64 LINUX TTL&#x3D;128 Windows 200x&#x2F;XP TTL&#x3D;255 Unix </p><h3 id="DNS解析过程"><a href="#DNS解析过程" class="headerlink" title="DNS解析过程"></a>DNS解析过程</h3><ol><li>用户输入网址，先查询本地DNS，本地DNS是一系列DNS的集合，比如ISP（Internet Service Provider）提供的DNS、公司网络提供的DNS。本地DNS是一个代理，将DNS请求转发到DNS网络中。如果本地DNS已经存在需要的记录，也就是本地DNS缓存中找到了对应的DNS条目，就会直接返回，而跳过之后的步骤</li><li>如果本地DNS服务器中没有对应的记录，那么请求回被转发到根DNS服务器。根DNS服务器只解析顶级域，例如”<a href="http://www.baidu.com&quot;,根服务器只查看com部分/">www.baidu.com&quot;,根服务器只查看com部分</a></li><li>根服务器返回顶级DNS服务器的IP</li><li>顶级域DNS服务器中存放的事二级域名的目录</li><li>顶级DNS服务器返回权威DNS服务器的IP</li><li>在权威服务器中存放具体的DNS记录</li><li>权威DNS服务器返回DNS记录到本地DNS服务器</li><li>本地DNS服务器返回具体的DNS记录给客户端</li></ol><h3 id="递归解析与迭代解析"><a href="#递归解析与迭代解析" class="headerlink" title="递归解析与迭代解析"></a>递归解析与迭代解析</h3><p><strong>递归算法</strong>只发出一次查询请求，要求服务器彻底地进行名字解析。当需要进一步查询时，本域名服务器向上级域名服务器返回其他域名服务器发出请求，直到查到记录。</p><p><strong>迭代查询</strong>可能发出多条请求，即上级域名服务器若返回的是其他域名服务器的地址，本域名服务器把这个地址发给用户，用户再进行深一级的查询。</p><p>DNS解析过程中： 223.5.5.5 是什么角色</p><p>在DNS解析过程中，223.5.5.5扮演的是公共DNS服务器的角色。它是由阿里云（Alibaba Cloud）提供的一个免费的DNS解析服务地址。当用户配置他们的网络设置以使用这个IP地址作为DNS服务器时，他们的DNS查询请求将会被发送到这个由阿里云运营的服务器。</p><h3 id="DNS安全"><a href="#DNS安全" class="headerlink" title="DNS安全"></a>DNS安全</h3><ol><li>常见的DNS攻击（如：DNS欺骗、缓存投毒等）：<br>DNS劫持（DNS Hijacking）：通过篡改DNS解析结果，讲用户引导至恶意网站。攻击者通过入侵DNS服务器或者用户的本地配置。<br>DNS缓存投毒（DNS Cache Poisoning）：攻击者通过向DNS服务器发送伪造的响应数据，污染其缓存，使得后续的DNS查询返回错误的IP地址<br>DNS放大攻击（DNS Amplification Attack）：是一种分布式拒绝服务（DDoS）攻击，攻击者利用开放的DNS服务器向目标发送大量伪造的查询请求，导致目标服务器因处理大量响应而瘫痪。攻击流量放大<br>DNS隧道攻击（DNS Tunneling Attack）：利用DNS协议进行数据泄漏或者绕过防火墙的技术。攻击者通过将数据编码到DNS查询和响应中，绕过传统的安全检查机制，实现隐蔽的数据传输。通常用于窃取敏感信息或者进行远程控制<br>DNS欺骗（DNS Spoofing）：攻击者伪造DNS响应，使得用户误以为访问的是合法网站，实际上却被引导至恶意站点。这种攻击通常与中间人攻击（MITM）结合使用，进一步窃取用户的敏感信息。</li><li>DNSSEC（DNS安全扩展）的基本概念：<br>DNSSEC（DNS安全扩展）是一种通过数字签名验证DNS响应真实性的技术。它可以有效防止DNS劫持、缓存投毒和欺骗攻击，确保用户访问的是合法的网站。</li></ol>]]></content>
    
    
    <summary type="html">DNS基础知识</summary>
    
    
    
    <category term="DNS" scheme="https://sgnyyyy.github.io/categories/DNS/"/>
    
    
  </entry>
  
  <entry>
    <title>Java常见手撕整理</title>
    <link href="https://sgnyyyy.github.io/2025/04/23/Java%E5%B8%B8%E8%A7%81%E6%89%8B%E6%92%95%E6%95%B4%E7%90%86/"/>
    <id>https://sgnyyyy.github.io/2025/04/23/Java%E5%B8%B8%E8%A7%81%E6%89%8B%E6%92%95%E6%95%B4%E7%90%86/</id>
    <published>2025-04-23T08:09:38.000Z</published>
    <updated>2025-05-07T10:21:43.794Z</updated>
    
    
    
    
    <category term="Java" scheme="https://sgnyyyy.github.io/categories/Java/"/>
    
    
  </entry>
  
  <entry>
    <title>素数筛</title>
    <link href="https://sgnyyyy.github.io/2025/03/14/%E7%B4%A0%E6%95%B0%E7%AD%9B/"/>
    <id>https://sgnyyyy.github.io/2025/03/14/%E7%B4%A0%E6%95%B0%E7%AD%9B/</id>
    <published>2025-03-13T16:38:35.000Z</published>
    <updated>2025-03-14T12:43:14.396Z</updated>
    
    <content type="html"><![CDATA[<h3 id="一般筛法"><a href="#一般筛法" class="headerlink" title="一般筛法"></a>一般筛法</h3><p>从2到sqrt(n)判断有没有因子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isPrime</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i &lt;= <span class="built_in">sqrt</span>(n);i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;一般筛法&quot;&gt;&lt;a href=&quot;#一般筛法&quot; class=&quot;headerlink&quot; title=&quot;一般筛法&quot;&gt;&lt;/a&gt;一般筛法&lt;/h3&gt;&lt;p&gt;从2到sqrt(n)判断有没有因子&lt;/p&gt;
&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Java集合源码分析</title>
    <link href="https://sgnyyyy.github.io/2024/12/26/Java%E9%9B%86%E5%90%88%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    <id>https://sgnyyyy.github.io/2024/12/26/Java%E9%9B%86%E5%90%88%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</id>
    <published>2024-12-26T05:56:26.000Z</published>
    <updated>2025-05-07T10:21:47.407Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ArrayList"><a href="#ArrayList" class="headerlink" title="ArrayList"></a>ArrayList</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>底层是数组队列，与Java中的数组相比，它的容量可以动态增长。</p><p>继承于AbstractList, 实现了List，RandomAccess，Cloneable，java.io.Serializeable接口</p><p>可以存储任何类型的对象，包括null值，但是不建议向ArrayList添加null值</p><h3 id="扩容机制"><a href="#扩容机制" class="headerlink" title="扩容机制"></a>扩容机制</h3><p>（JDK8）以无参数构造方法创建ArrayList时，实际上初始化赋值的是一个空数组。当真正对数组进行添加元素操作时，才真正分配容量。即向数组中添加第一个元素时，数组容量扩为10。</p><p>扩容 grow()函数<br>先将新容量扩大为原来的1.5倍<br>判断新容量是否大于最小需要容量<br>如果小于，最小需要容量就作为新容量<br>判断新容量是否大于MAX_ARRAY_SIZE<br>如果大于，进入hugeCapacity()函数，比较最小需要容量和MAX_ARRAY_SIZE，如果最小需要容量大于MAX_ARRAY_SIZE，新容量为Integer.MAX_VALUE，否则，新容量为MAX_ARRAY_SIZE，即为Integer.MAX_VALUE-8</p><h2 id="LinkedList"><a href="#LinkedList" class="headerlink" title="LinkedList"></a>LinkedList</h2><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p>基于双向链表实现，项目中一般不会用到，需要用到LinkedList的场景几乎都可以用ArrayList代替。</p><p>LinkedList继承了AbstractSequentialList，而AbstractSequentialList又继承于AbstractList。实现了List，Deque，Cloneable，Serializable接口</p><h2 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h2><h3 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h3><p>基于哈希表的Map接口实现，非线程安全</p><p>可以存储null的key和value，但null作为键只能有一个，null作为值可以多个</p><p>JDK1.8之前，数组加链表，数组是主体，链表是为了解决哈希冲突存在的</p><p>通过key的hashCode经过扰动函数（HashMap的hash方法，防止一些实现比较差的hashCode（）方法，减少碰撞）处理后得到hash值，通过(n-1)&amp;hash判断当前元素存放的位置（n指的是数组的长度），如果当前元素存在元素，就判断该元素与要存入元素的hash值以及key是否相同，如果相同，直接覆盖，如果不同就通过拉链法解决。</p><p>JDK1.8之后，当链表长度大于等于阈值（默认为8）（将链表转为红黑树前会判断，如果当前数组的长度小于64，那么会选择先进行数组扩容，而不是转换为红黑树）时，将链表转化为红黑树，以减少搜索时间。</p><p>HashMap默认的初始化大小为16，之后每次扩充，容量变为原来的2倍。并且，HashMap总是使用2的幂作为哈希表的大小。</p><ul><li><p>loadFactor负载因子<br>负载因子控制数组存放数据的疏密程度，0.75f是官方给出的比较好的临界值。太大导致查找元素效率低，太小导致数组的利用率低</p></li><li><p>threshold<br>threshold&#x3D;capacity * loadFactor，当size &gt; threshold，考虑数组的扩增</p></li></ul><h3 id="扩容："><a href="#扩容：" class="headerlink" title="扩容："></a>扩容：</h3><p>超过最大值就不再扩容，直接返回table</p><p>没超过最大值，扩充为原来的两倍，threshold也是两倍</p><h2 id="ConcurrentHashMap"><a href="#ConcurrentHashMap" class="headerlink" title="ConcurrentHashMap"></a>ConcurrentHashMap</h2><h3 id="JDK1-7"><a href="#JDK1-7" class="headerlink" title="JDK1.7"></a>JDK1.7</h3><p>由很多个Segment组合，每个Segment类似于HashMap结构，HashMap内部可以进行扩容，但是Segment的个数一旦初始化就不变化。（Segment默认16，可以认为ConcurrentHashMap默认支持16个线程并发）</p><p>使用分段锁，每个Segment上同时只有一个线程可以操作。</p><h3 id="JDK1-8"><a href="#JDK1-8" class="headerlink" title="JDK1.8"></a>JDK1.8</h3><p>Node数组+链表&#x2F;红黑树，当冲突链表达到一定长度时，链表会转换成红黑树</p><p>使用Synchronized锁加CAS的机制</p><h2 id="CopyOnWriteArrayList"><a href="#CopyOnWriteArrayList" class="headerlink" title="CopyOnWriteArrayList"></a>CopyOnWriteArrayList</h2><p>JDK1.5引入了Java.util.concurrent(JUC)包，其中提供了很多线程安全且并发性能良好的容器，其中唯一的线程安全List实现就是CopyOnWriteArrayList。</p><p>写时复制。CopyOnWriteArrayList中的读取操作完全无需加锁，写入操作也不会阻塞读操作，只有写写才会互斥。</p><p>当需要修改（add，set，remove等操作）CopyOnWriteArrayList的内容时，不会直接修改原数组，而是会先创建底层数组的副本，对副本数组进行修改，修改完之后再将修改后的数组赋值回去。</p><p>适合读多写少的并发场景。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ArrayList&quot;&gt;&lt;a href=&quot;#ArrayList&quot; class=&quot;headerlink&quot; title=&quot;ArrayList&quot;&gt;&lt;/a&gt;ArrayList&lt;/h2&gt;&lt;h3 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="Java" scheme="https://sgnyyyy.github.io/categories/Java/"/>
    
    
  </entry>
  
  <entry>
    <title>排序算法整理</title>
    <link href="https://sgnyyyy.github.io/2024/12/26/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/"/>
    <id>https://sgnyyyy.github.io/2024/12/26/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%95%B4%E7%90%86/</id>
    <published>2024-12-26T05:46:53.000Z</published>
    <updated>2025-02-17T13:25:18.838Z</updated>
    
    <content type="html"><![CDATA[<h2 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h2><h2 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h2><h2 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h2><h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><p>最好情况O(nlogn),最坏情况 $O(n^2)$ ，平均情况O(nlogn)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">quickSort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> mid = <span class="built_in">partition</span>(l, r, nums);</span><br><span class="line">    <span class="comment">//递归排序左边和右边</span></span><br><span class="line">    <span class="built_in">quickSort</span>(mid+<span class="number">1</span>, r, nums);</span><br><span class="line">    <span class="built_in">quickSort</span>(l, mid<span class="number">-1</span>, nums);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">partition</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> pivot = nums[l]; <span class="comment">//以最左边元素为基准</span></span><br><span class="line">    <span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line">        <span class="keyword">while</span>(l &lt; r &amp;&amp; nums[r] &gt;= pivot) r--;</span><br><span class="line">        nums[l] = nums[r];</span><br><span class="line">        <span class="keyword">while</span>(l &lt; r &amp;&amp; nums[l] &lt;= pivot) l++;</span><br><span class="line">        nums[r] = nums[l];</span><br><span class="line">    &#125;</span><br><span class="line">    nums[l] = pivot;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">    <span class="built_in">quickSort</span>(<span class="number">0</span>, n<span class="number">-1</span>, nums);</span><br><span class="line">    <span class="keyword">return</span> nums;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">quickSort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="type">int</span> mid = <span class="built_in">partition</span>(l, r, nums);</span><br><span class="line">        <span class="built_in">quickSort</span>(mid+<span class="number">1</span>, r, nums);</span><br><span class="line">        <span class="built_in">quickSort</span>(l, mid<span class="number">-1</span>, nums);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">partition</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span>&#123;</span><br><span class="line">        <span class="type">int</span> i = <span class="built_in">rand</span>() % (r - l + <span class="number">1</span>) + l; <span class="comment">// 随机选一个作为我们的主元</span></span><br><span class="line">        <span class="built_in">swap</span>(nums[r], nums[i]);</span><br><span class="line">        <span class="type">int</span> pivot = nums[r];</span><br><span class="line">        i = l<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = l;j &lt; r;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[j] &lt; pivot)&#123;</span><br><span class="line">                i = i+<span class="number">1</span>;</span><br><span class="line">                <span class="built_in">swap</span>(nums[i],nums[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        i = i+<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">swap</span>(nums[i], nums[r]);</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="built_in">quickSort</span>(<span class="number">0</span>, n<span class="number">-1</span>, nums);</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h2><p>最好情况下O(nlogn)，最坏情况下O(nlogn)，平均情况下O(nlogn)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; tmp;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">mergeSort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">mergeSort</span>(l, mid, nums);</span><br><span class="line">        <span class="built_in">mergeSort</span>(mid+<span class="number">1</span>, r, nums);</span><br><span class="line">        <span class="type">int</span> i = l, j = mid+<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i &lt;= mid &amp;&amp; j &lt;= r)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] &lt;= nums[j])&#123;</span><br><span class="line">                tmp[k++] = nums[i++];</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                tmp[k++] = nums[j++];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(i &lt;= mid)&#123;</span><br><span class="line">            tmp[k++] = nums[i++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(j &lt;= r)&#123;</span><br><span class="line">            tmp[k++] = nums[j++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; r-l+<span class="number">1</span>;i++)&#123;</span><br><span class="line">            nums[i+l] = tmp[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        tmp.<span class="built_in">resize</span>(n);</span><br><span class="line">        <span class="built_in">mergeSort</span>(<span class="number">0</span>, n<span class="number">-1</span>, nums);</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h2><p>最好情况下O(nlogn)，最坏情况下O(nlogn)，平均情况下O(nlogn)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> len = nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">    <span class="comment">//先建一个大根堆</span></span><br><span class="line">    <span class="built_in">buildMaxHeap</span>(nums, len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = len;i &gt;= <span class="number">1</span>; --i)&#123;</span><br><span class="line">        <span class="comment">//将堆顶和最后一个元素交换位置</span></span><br><span class="line">        <span class="built_in">swap</span>(nums[i], nums[<span class="number">0</span>]);</span><br><span class="line">        len -= <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//最后i个已经排好序，将前len-i个继续建一个大根堆，重复以上过程</span></span><br><span class="line">        <span class="built_in">maxHeapify</span>(nums,<span class="number">0</span>,len);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">buildMaxHeap</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//从最后一个父节点开始判断，让每个父节点都大于自己的孩子节点</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = len / <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="built_in">maxHeapify</span>(nums, i, len);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">maxHeapify</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> i, <span class="type">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// for循环递归调整受影响的子树</span></span><br><span class="line">    <span class="keyword">for</span> (; (i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span> &lt;= len;) &#123;</span><br><span class="line">        <span class="type">int</span> lson = (i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> rson = (i &lt;&lt; <span class="number">1</span>) + <span class="number">2</span>;</span><br><span class="line">        <span class="type">int</span> large;</span><br><span class="line">        <span class="keyword">if</span> (lson &lt;= len &amp;&amp; nums[lson] &gt; nums[i]) &#123;</span><br><span class="line">            large = lson;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            large = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (rson &lt;= len &amp;&amp; nums[rson] &gt; nums[large]) &#123;</span><br><span class="line">            large = rson;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (large != i) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(nums[i], nums[large]);</span><br><span class="line">            i = large;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">heapSort</span>(nums);</span><br><span class="line">    <span class="keyword">return</span> nums;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;冒泡排序&quot;&gt;&lt;a href=&quot;#冒泡排序&quot; class=&quot;headerlink&quot; title=&quot;冒泡排序&quot;&gt;&lt;/a&gt;冒泡排序&lt;/h2&gt;&lt;h2 id=&quot;插入排序&quot;&gt;&lt;a href=&quot;#插入排序&quot; class=&quot;headerlink&quot; title=&quot;插入排序&quot;&gt;&lt;/a</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://sgnyyyy.github.io/2023/02/23/hello-world/"/>
    <id>https://sgnyyyy.github.io/2023/02/23/hello-world/</id>
    <published>2023-02-23T08:53:12.000Z</published>
    <updated>2022-03-11T00:42:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
